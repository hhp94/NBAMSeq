---
title: "modding"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{modding}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Todo 
Simplify the `results1` and return function and possibly add `gamm`. But for now this is sufficient. Expect the function to still run very slowly because of the multiple steps and how each model is running 15k+ genes.

The current results function doesn't handle more complicated smooths. Also contrasting should be done at the fitting level. Needs to rewrite `results1`.

# Scratchpad
```{r setup}
library(devtools)
library(testthat)
library(microbenchmark)
load_all()

set.seed(1234)
sim1 <- makeExample(n = 10, m = 10)
sim1$id <- factor(seq_along(sim1$pheno))
sim1$f <- factor(rbinom(ncol(sim1), 1, 0.5)) 
sim1@design <- ~ f + s(pheno, by = f) + s(id, bs = "re")

debug(NBAMSeq1)
debug(gamFit2)
sim_fit <- NBAMSeq1(sim1)
mcols(sim_fit)$fit[[4]]
```

```{r}

```

```{r setup}
library(mgcv)
d <- gam(mpg ~ s(drat), data = mtcars)

lobstr::obj_size(summary(d))
```
